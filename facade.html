<script type="text/javascript">
//外观模式非常适合于浏览器脚本处理，可以将浏览器之间的差异隐藏在外观之后。比如说事件API、AJAX等，IE低版本浏览器和W3C标准存在一定差异，这时候可以提供一个“外观”给外部调用，将处理细节隐藏起来，同时也能将细节处理的代码从逻辑代码中解耦出来。
  var utils = (function() {
  var addEventListener = null,
    removeEventListener = null,
    preventDefault = null,
    stopPropagation = null;

  if (window.addEventListener) {
    addEventListener = function(el, ev, handler) {
      el.addEventListener(ev, handler, false);
    };
    removeEventListener = function(el, ev, handler) {
      el.removeEventListener(ev, handler, false);
    };
  } else if (document.attachEvent) {
    addEventListener = function(el, ev, handler) {
      el.attachEvent('on' + ev, handler);
    };
    removeEventListener = function(el, ev, handler) {
      el.detachEvent('on' + ev, handler);
    };
  } else {
    addEventListener = function(el, ev, handler) {
      el['on' + ev] = handler;
    };
    removeEventListener = function(el, ev, handler) {
      el['on' + ev] = null;
    };
  }

  //通过首次运行重写preventDefault，防止后续重复检测
  //阻止浏览器的默认行为
  preventDefault = function(e) {
    if (typeof e.preventDefault === 'function') {
      e.preventDefault();
      preventDefault = function(e) {
        e.preventDefault();
      };
      return;
    }

    if (typeof e.returnValue === 'boolean') {
      e.returnValue = false;
      preventDefault = function(e) {
        e.returnValue = false;
      };
      return;
    }
  };

  //阻止事件冒泡
  stopPropagation = function(e) {
    if (typeof e.stopPropagation === 'function') {
      e.stopPropagation();
      stopPropagation = function(e) {
        e.stopPropagation();
      };
      return;
    }

    if (typeof e.cancelBubble === 'boolean') {
      e.cancelBubble = true;
      stopPropagation = function(e) {
        e.cancelBubble = true;
      };
      return;
    }
  };

  //阻止默认行为和阻止事件冒泡
  function stop(e) {
    preventDefault(e);
    stopPropagation(e);
  }

  return {
    addEventListener: addEventListener,
    removeEventListener: removeEventListener,
    stop: stop
  };
}());
</script>